<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<!-- EDIT THIS-->
		<title>Tutorial - GameMaker Extending Space Rocks - Ch1 - Page 3</title>
		<!-- DO NOT EDIT THIS-->
		<meta http-equiv="X-UA-Compatible" content="IE=9" />
		<link rel="stylesheet" href="../style.css" type="text/css" media="screen" title="style" charset="UTF-8"/>
		<script type="text/javascript">
			var changePage = function(){
				var newPage = document.getElementById("page-select");
				window.location.replace(newPage.value);
				}
		</script>

	</head>

<!-- EDIT THIS - This section is where you can add an index to your tutorial -->
<body>
<!-- EDIT THIS - Your Tutorial title -->
	<h2 style="border-radius:0.5em 0.5em 0 0; margin:0;">Tutorial - Extending Space Rocks</h2>
<!-- EDIT THIS - Here you list the pages in your tutorial, with the current one at the top -->
		<div class="head">
			<select id="page-select" onChange="changePage()">
				
				<optgroup label="Chapter 1 - Extending Space Rocks">
		
					<option value="page03.html">Add Panache Part I</option>
					<option value="page04.html">Add Panache Part II</option>
					<option value="page05.html">Add Friction and Max Speed</option>
				</optgroup>
				<optgroup label="Ch 2 - Spawning Asteroids">
					<option value="../ch2/page01.html">Pick Spawn by Time or Score</option>
					<option value="../ch2/page02.html">Spawn by Time</option>
					<option value="../ch2/page03.html">Spawn by Score</option>
				</optgroup>
				<optgroup label="---Previous Pages">
					<optgroup label="Ch1 - Extending Space Rocks">
					<option value="../page01.html"><b>Importing Project Files</b></option>
					<option value="page02.html">Variables</option>
				</optgroup>
			</optgroup>
			</select>
		</div>
	
<!-- EDIT THIS - Main tutorial body goes here -->
<div class="body-scroll">
	<p>
	If you want to see tutorial in a separate web browser window <a href="gms2tutorials:///openBrowser">click here</a>.
	
	<p style="color:rgb(85, 109, 130)">
	<b>Add Panache Part I</b>

	<p>
		Let us start by adding some panache to our game.  First I think the ship should be smaller.  The size of the game window and rocks is small and the ship seems large.  We will resize the ship.

	<p> 
		Double left click <tt><b>spr_ship</b></tt> and click the <tt><b>Resize Sprite</b></tt> button (four arrows):

	<p>
		<img class="center" src="http://marcaubanel.com/gamemaker/GMS2-Images/Extending-Space-Rocks/CH1/SprShipResize.png" alt="Press resite sprite button on spr_ship">
	
	<p> 
	
		Select <tt><b>Scale Image</b></tt> and change it to a <tt><b>Width</b></tt> and <tt><b>Height</b></tt> of <tt><b>16</b></tt> by <tt><b>16</b></tt>.  Press the <tt><b>Apply</b></tt> button.  In my case my line was thick enough that it looks good.  If the shrinking makes it look bad, then press <tt><b>Edit Image</b></tt> and redraw the ship.
	
	<p>
		<img class="center" src="http://marcaubanel.com/gamemaker/GMS2-Images/Extending-Space-Rocks/CH1/ScaleTo16By16Apply.png" alt="Scale ship down to 16 by 16">

	<p> 
		Double check the origin of the sprite.  In my case it was changed so recenter it so that it is at 8 and 8 (Middle Center).
	
	<p>
		<img class="center" src="http://marcaubanel.com/gamemaker/GMS2-Images/Extending-Space-Rocks/CH1/RecenterOriginSprShip.png" alt="Recenter origin on resized ship">

	<p> 
		Run the game by pressing the <img style="vertical-align:middle" src="http://marcaubanel.com/gamemaker/GMS2-Images/Shared/Icon_RunProject.png" alt="Play button"> <tt><b>Play Button</b></tt> in the top menu bar to launch the game.  The ship should now fit into the game window a bit better (at least this is my personal opinion).

	<p>
		<img class="center" src="http://marcaubanel.com/gamemaker/GMS2-Images/Extending-Space-Rocks/CH1/SixteenPixelShip.gif" alt="Play game and look at new ship size">

	<p> 
		Double <img style="vertical-align:middle" src="http://marcaubanel.com/gamemaker/GMS2-Images/Shared/Icon_LMB.png" alt="Left mouse button illustration"> left click <tt><b>spr_ship</b></tt> and in the menu above right click on the ship icon.  Select <tt><b>copy</b></tt> and <tt><b>paste</b></tt> to add another frame to the ship.

	<p>
		<img class="center" src="http://marcaubanel.com/gamemaker/GMS2-Images/Extending-Space-Rocks/CH1/AddFlameFameInShip.png" alt="An second frame to spr_ship">

	<p> 
		Now press the <tt><b>Edit Image</b></tt> button and select frame 0 (the first frame).  Fill the blank space behind the ship with a red color using the pencil tool:

	<p>
		<img class="center" src="http://marcaubanel.com/gamemaker/GMS2-Images/Extending-Space-Rocks/CH1/AddFlameToFrame0.png" alt="Add flame">		
		
	<p> 
		Run the game by pressing the <img style="vertical-align:middle" src="http://marcaubanel.com/gamemaker/GMS2-Images/Shared/Icon_RunProject.png" alt="Play button"> <tt><b>Play Button</b></tt> in the top menu bar to launch the game.  The flame is really hard to see but it is flashing on and off.  We want it on when we are accelerating and off the rest of the time.

	<p>
		<img class="center" src="http://marcaubanel.com/gamemaker/GMS2-Images/Extending-Space-Rocks/CH1/FlashingFlameTooSmall.gif" alt="Play game, notice that flame is hard to see?">		

	<p> 
		Open <tt><b>spr_ship</b></tt> and look at the two frames.  These are accessed through the variable <b><a href="gms2tutorials:///ShowHelp?tag=image_index">image_index</a></b>.  The first frame is frame 0, the 2nd frame 1 and so on.

	<p>
		<img class="center" src="http://marcaubanel.com/gamemaker/GMS2-Images/Extending-Space-Rocks/CH1/ImageIndex0And1.png" alt="image_index in spr_ship showing 0 and 1">		
	
	<p> 
		 Open <tt><b>obj_ship</b></tt> and look for where you check for the <tt><b>vk_up</b></tt> press to accelerate.  Add an <tt><b>image_index</b></tt> there to add the flame. After this if you want to add an <tt><b>else</b></tt> and reset it to the frame without a flame.
		<h3><tt>obj_ship: Step</tt></h3>
	<p>
		<img class="center" src="http://marcaubanel.com/gamemaker/GMS2-Images/Extending-Space-Rocks/CH1/TurnShipFlameOnOff.png" alt="Add image_index change when accelerating to obj_ship step event">		

		<p>
		Run the game by pressing the <img style="vertical-align:middle" src="http://marcaubanel.com/gamemaker/GMS2-Images/Shared/Icon_RunProject.png" alt="Play button"> <tt><b>Play Button</b></tt> in the top menu bar to launch the game.  The flame that is still hard to see now turns on and off with acceleration.
		
	<p>
		<img class="center" src="http://marcaubanel.com/gamemaker/GMS2-Images/Extending-Space-Rocks/CH1/SmallFlameShipOnOff.gif" alt="Run game and see flame turn on and off">

	<p>
		Lets make the flame a bit bigger and more obvious.  There are a few ways we could approach it. We could make the sprite larger and add the flame to it.  This would make us move the origin off center which would alter our <tt><b>move_wrap()</b></tt> as it will be non-symetrical.  We could also draw another sprite in the <tt><b>draw</b></tt> event of <tt><b>obj_ship</b></tt>.

	<p>
		There is always more than one way to solve any problem.  In this case I propose we build another sprite and object and position it behind the ship.  We will then have it follow the ship every frame.  Lets start by looking at what we need to do.  
		
	<p>
			We need a second sprite of the same size to match up to the first so it looks like one contiguous sprite when combined like so:

	<p>
		<img class="center" src="http://marcaubanel.com/gamemaker/GMS2-Images/Extending-Space-Rocks/CH1/DrawBackFlameSprite.jpg" alt="Combine two sprites one of ship and one of flame to look like one">

	<p>
		So we will need to figure out where to draw the sprite.  Lets look at the top left and bottom left of our flame in the y axis.  We can start drawing on the right hand side of the sprite.  The editor can help us here.  <img style="vertical-align:middle" src="http://marcaubanel.com/gamemaker/GMS2-Images/Shared/Icon_LMB.png" alt="Left mouse button illustration"> Double left click and open <tt><b>spr_ship</b></tt> and press the <tt><b>Edit Image</b></tt> button. Select the pen tool and hover over the top left corner.

	<p>
		At the bottom corner of the screen we see the (x,y) position of the cursor.  In my case it is <tt><b>3</b></tt> on the y axis of this sprite.

	<p>
		<img class="center" src="http://marcaubanel.com/gamemaker/GMS2-Images/Extending-Space-Rocks/CH1/TopLeftY.png" alt="Look at bottom corner y position of flame">

	<p>
		Lets look at the bottom left of our flame in the y axis.  Hover over the bottom left corner.

	<p>
		At the bottom corner of the screen we see the (x,y) position of the cursor.  In my case it is <tt><b>12</b></tt> on the y axis of this sprite. 

	<p>
		So we need to start on the new sprite to draw on the right hand side from 3 on the y to 12 on the y then taper downward.

	<p>
		<img class="center" src="http://marcaubanel.com/gamemaker/GMS2-Images/Extending-Space-Rocks/CH1/BottomLeftY.png" alt="Show top left corner y position of flame">

	<p>
		<img style="vertical-align:middle" src="http://marcaubanel.com/gamemaker/GMS2-Images/Shared/Icon_RMB.png" alt="Right button illustration"> Right click on <tt><b>Sprite</b></tt> in the <tt><b>Resource</b></tt> menu.  Call it <tt><b>spr_ship_flame</b></tt>.  Change the scale of the sprite by <tt><b>16</b></tt> by <tt><b>16</b></tt>.  
		
	<p>
		Press the <tt><b>Edit Sprite</b></tt> button and select the flame color and the pencil tool.  Put a dot at the top right corner (in my case at 3 on the y) and then the bottom (in my case 12 on the y) then fill inbetween.  Work your way to taper the flame to the left to your liking.

	<p>
		<img class="center" src="http://marcaubanel.com/gamemaker/GMS2-Images/Extending-Space-Rocks/CH1/DrawSprShipFlame2.gif" alt="Draw flame to mirror other sprite">

	<p>
		Center the origin on the sprite on <tt><b>spr_ship_flame</b></tt> to <tt><b>Middle | Center</b></tt>:

	<p>
		<img class="center" src="http://marcaubanel.com/gamemaker/GMS2-Images/Extending-Space-Rocks/CH1/CenterFlameOrigin.png" alt="Center origin of sprite">

	<p>
		Now <img style="vertical-align:middle" src="http://marcaubanel.com/gamemaker/GMS2-Images/Shared/Icon_RMB.png" alt="Right button illustration"> right click on <tt><b>Objects</b></tt> and select <tt><b>Create Object</b></tt>.  Call it <tt><b>obj_ship_flame</b></tt> and assign the <tt><b>spr_ship_flame</b></tt>.

	<p>
		<img class="center" src="http://marcaubanel.com/gamemaker/GMS2-Images/Extending-Space-Rocks/CH1/ObjShipFlame.png" alt="Create obj_ship_flame and add spr_ship_flame to the sprite component">

	<p>
		How do we position the flame to always be behind the ship?  
		
	<p>
		Lets look at a visual.  The ship's image_angle is its forward angle.  To position directly behind we need to subtract that angle by 180 degrees.  Then we need to move backwards by the width of the sprite like so:

	<p>
		<img class="center" src="http://marcaubanel.com/gamemaker/GMS2-Images/Extending-Space-Rocks/CH1/HowToPositionBackFlame.png" alt="Illustrate the angle and amount flame needs to be behind ship sprite">

	<p>
		Add a <tt><b>Step Event</b></tt> to <tt>obj_ship_flame</tt>. 

		<p>
		First we need to rotate the <tt><b>obj_ship_flame</b></tt> to match the <tt><b>image_angle</b></tt> of <tt><b>obj_ship</b></tt>.  Since we are in the namespace of <tt><b>obj_ship_flame</b></tt> how do we see a variable in another object?

	<p>
		Since we only have a single instance of <tt><b>obj_ship</b></tt> we can access its variables by dot referencing.  If we type <tt><b>obj_ship.VARIABLE_NAME</b></tt> and replace VARIABLE_NAME with a legitimate variable name we can access it.  We are able to access variables in other game objects this way (these variables are public).  So it would look like this:

	<p>
		<img class="center" src="http://marcaubanel.com/gamemaker/GMS2-Images/Extending-Space-Rocks/CH1/RotateToMatchShip.jpg" alt="Dot reference variable in obj_ship">
		
	
	<p>
		The next step is to add the current position of the ship with an offset 180% behind us at a distance of sprite_width.  We can accomplish this with <b><a href="gms2tutorials:///ShowHelp?tag=lengthdir_x">lengthdir_x(len, dir)</a></b> and <b><a href="gms2tutorials:///ShowHelp?tag=lengthdir_y">lengthdir_y(len, dir)</a></b>. 
		
		<p>
			Click on these links to see how they work.  Each one takes a <tt><b>len</b></tt> (length in pixels) and a <tt><b>dir</b></tt> (angle in degrees).  They each return the x or y component of the position of that point on screen. They are essentially converting from the Polar Coordinate system to the Cartesian Coordinate system.  We take an angle and a magnitude and add our current position to get the new one.  In code it looks like:
	<p class = "code">
		x = lengthdir_x(sprite_width, image_angle - 180) + obj_ship.x;
		y = lengthdir_y(sprite_width, image_angle - 180) + obj_ship.y;

	<p>
		<img class="center" src="http://marcaubanel.com/gamemaker/GMS2-Images/Extending-Space-Rocks/CH1/ConvertToCartesian.png" alt="Show conversion from polar to cateresian in flame">

	<p>
		Drag and drop <tt><b>obj_ship_flame</b></tt> into <tt><b>rm_game</b></tt>.  It doesn't matter where you place it as the step event will adjust the position.

		<p>
		<img class="center" src="http://marcaubanel.com/gamemaker/GMS2-Images/Extending-Space-Rocks/CH1/PutObjShipFlameInRoom.png" alt="Drag obj_ship_flame into rm_game">

		
	<p>
		Run the game by pressing the <img style="vertical-align:middle" src="http://marcaubanel.com/gamemaker/GMS2-Images/Shared/Icon_RunProject.png" alt="Play button"> <tt><b>Play Button</b></tt> in the top menu bar to launch the game.  The flame is following and is always on.  We will fix that shortly.
		
	<p>
		If you get a crash when you hit a rock, don't worry, we will be fixing this as well.
		
	<p> 
		Game development is about sweating the small details.  Look at the animation <i>very</i> closely, it looks like it is a frame behind the ship and is catching up when it is moving.  This is because of a timing error. On the next page we will fix this problem.
		
	<p>
		<img class="center" src="http://marcaubanel.com/gamemaker/GMS2-Images/Extending-Space-Rocks/CH1/FlameAlwaysOnFollowShip.gif" alt="Run game and see that flame lags ship">

		
<br>
</p>
<p>

</div>

<div class="footer">
	<div class="buttons">
		<div class="clear">
			<div style="float:left">
				<a href="page02.html"  class="prev">
				<div id="button-prev"></div> 
				</a>
			</div>
			<div style="float:right"> <!-- Set the next page to go to here -->
				<a href="page04.html" class="next">
					<div id="button-next"></div>
				</a>
			</div>
		</div>	
	</div>
<!-- Footer copyright notice - set this to your own or whatever is required (remove the text but leave the <h5> tags to just have the bar) -->
<h5>&copy; Copyright Mauby Games 2018</h5>
</div>

</body>
</html>



